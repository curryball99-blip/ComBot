{"ast":null,"code":"import _objectSpread from\"/home/ubuntu/Ravi/ComBot/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/ubuntu/Ravi/ComBot/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"node\",\"inline\",\"className\",\"children\"],_excluded2=[\"children\",\"href\"];import React from'react';import{motion}from'framer-motion';import{User,Bot,Copy,ExternalLink,AlertCircle}from'lucide-react';import{format}from'date-fns';import ReactMarkdown from'react-markdown';import{Prism as SyntaxHighlighter}from'react-syntax-highlighter';import{tomorrow}from'react-syntax-highlighter/dist/esm/styles/prism';import ChartRenderer from'../Charts/ChartRenderer';import UNODashboard from'../Charts/UNODashboard';import FeedbackButtons from'./FeedbackButtons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageBubble=_ref=>{let{message,isLast}=_ref;const[copied,setCopied]=React.useState(false);const handleFeedback=async(messageId,type,content)=>{try{await fetch('/api/feedback',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({messageId,type,content})});}catch(error){console.error('Feedback error:',error);}};const handleCopy=async text=>{try{await navigator.clipboard.writeText(text);setCopied(true);setTimeout(()=>setCopied(false),2000);}catch(err){console.error('Failed to copy text:',err);}};const formatTimestamp=timestamp=>{try{return format(new Date(timestamp),'MMM d, h:mm a');}catch(_unused){return'';}};const messageVariants={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};if(message.type==='user'){return/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex justify-end items-start space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-message\",children:/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap break-words\",children:message.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 text-right mt-1\",children:formatTimestamp(message.timestamp)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-comviva-primary rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-white\"})})]});}if(message.type==='error'){return/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl rounded-tl-md px-4 py-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-red-800 dark:text-red-200 whitespace-pre-wrap break-words\",children:message.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:formatTimestamp(message.timestamp)})]})]});}// Bot message\nreturn/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-comviva-secondary rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(Bot,{className:\"w-4 h-4 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-2xl rounded-tl-md px-4 py-3 max-w-none overflow-hidden shadow-sm\",children:/*#__PURE__*/_jsx(\"div\",{className:\"markdown-content prose prose-sm max-w-none break-words overflow-wrap-anywhere text-gray-800 dark:text-gray-200\",children:message.isStreaming&&!message.content?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 text-gray-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.1s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.2s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Thinking...\"})]}):/*#__PURE__*/_jsx(ReactMarkdown,{components:{code(_ref2){let{node,inline,className,children}=_ref2,props=_objectWithoutProperties(_ref2,_excluded);const match=/language-(\\w+)/.exec(className||'');return!inline&&match?/*#__PURE__*/_jsx(SyntaxHighlighter,_objectSpread(_objectSpread({style:tomorrow,language:match[1],PreTag:\"div\",className:\"rounded-lg !mt-2 !mb-2 text-sm\"},props),{},{children:String(children).replace(/\\n$/,'')})):/*#__PURE__*/_jsx(\"code\",_objectSpread(_objectSpread({className:\"bg-gray-100 dark:bg-gray-700 text-comviva-primary dark:text-blue-400 px-1.5 py-0.5 rounded text-sm font-mono\"},props),{},{children:children}));},a(_ref3){let{children,href}=_ref3,props=_objectWithoutProperties(_ref3,_excluded2);return/*#__PURE__*/_jsxs(\"a\",_objectSpread(_objectSpread({href:href,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-comviva-primary hover:text-blue-700 underline inline-flex items-center gap-1 font-medium\"},props),{},{children:[children,/*#__PURE__*/_jsx(ExternalLink,{className:\"w-3 h-3\"})]}));},p(_ref4){let{children}=_ref4;return/*#__PURE__*/_jsx(\"p\",{className:\"mb-2 leading-relaxed\",children:children});},ul(_ref5){let{children}=_ref5;return/*#__PURE__*/_jsx(\"ul\",{className:\"mb-2 ml-4 space-y-1\",children:children});},ol(_ref6){let{children}=_ref6;return/*#__PURE__*/_jsx(\"ol\",{className:\"mb-2 ml-4 space-y-1\",children:children});},li(_ref7){let{children}=_ref7;return/*#__PURE__*/_jsx(\"li\",{className:\"text-gray-700 dark:text-gray-300\",children:children});},strong(_ref8){let{children}=_ref8;return/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold text-gray-900 dark:text-white\",children:children});},h1(_ref9){let{children}=_ref9;return/*#__PURE__*/_jsx(\"h1\",{className:\"text-lg font-semibold text-gray-900 dark:text-white mb-2 mt-3\",children:children});},h2(_ref0){let{children}=_ref0;return/*#__PURE__*/_jsx(\"h2\",{className:\"text-base font-semibold text-gray-900 dark:text-white mb-2 mt-3\",children:children});},h3(_ref1){let{children}=_ref1;return/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-900 dark:text-white mb-1 mt-2\",children:children});},blockquote(_ref10){let{children}=_ref10;return/*#__PURE__*/_jsx(\"blockquote\",{className:\"border-l-4 border-comviva-primary pl-4 py-2 bg-blue-50 dark:bg-blue-900/20 rounded-r-lg mb-2 italic\",children:children});},table(_ref11){let{children}=_ref11;return/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto my-4\",children:/*#__PURE__*/_jsx(\"table\",{className:\"min-w-full border border-gray-200 dark:border-gray-600 rounded-lg\",children:children})});},thead(_ref12){let{children}=_ref12;return/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-700\",children:children});},tbody(_ref13){let{children}=_ref13;return/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600\",children:children});},tr(_ref14){let{children}=_ref14;return/*#__PURE__*/_jsx(\"tr\",{children:children});},th(_ref15){let{children}=_ref15;return/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider border-b border-gray-200 dark:border-gray-600\",children:children});},td(_ref16){let{children}=_ref16;return/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-600\",children:children});}},children:message.content})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:formatTimestamp(message.timestamp)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(FeedbackButtons,{messageId:message.id,content:message.content,onFeedback:handleFeedback}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleCopy(message.content),className:\"text-xs text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 flex items-center space-x-1 transition-colors\",children:[/*#__PURE__*/_jsx(Copy,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:copied?'Copied!':'Copy'})]})]})]})]})]});};export default MessageBubble;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}