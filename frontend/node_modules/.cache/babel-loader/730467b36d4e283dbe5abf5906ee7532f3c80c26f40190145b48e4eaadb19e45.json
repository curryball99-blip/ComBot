{"ast":null,"code":"import _objectSpread from\"/home/im/Druthik/clean_rag/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/im/Druthik/clean_rag/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"node\",\"inline\",\"className\",\"children\"],_excluded2=[\"children\",\"href\"];import React from'react';import{motion}from'framer-motion';import{User,Bot,Copy,ExternalLink,AlertCircle}from'lucide-react';import{format}from'date-fns';import ReactMarkdown from'react-markdown';import{Prism as SyntaxHighlighter}from'react-syntax-highlighter';import{tomorrow}from'react-syntax-highlighter/dist/esm/styles/prism';import ChartRenderer from'../Charts/ChartRenderer';import UNODashboard from'../Charts/UNODashboard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessageBubble=_ref=>{let{message,isLast}=_ref;const[copied,setCopied]=React.useState(false);const handleCopy=async text=>{try{await navigator.clipboard.writeText(text);setCopied(true);setTimeout(()=>setCopied(false),2000);}catch(err){console.error('Failed to copy text:',err);}};const formatTimestamp=timestamp=>{try{return format(new Date(timestamp),'MMM d, h:mm a');}catch(_unused){return'';}};const messageVariants={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};if(message.type==='user'){return/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex justify-end items-start space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-message\",children:/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap break-words\",children:message.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 text-right mt-1\",children:formatTimestamp(message.timestamp)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-comviva-primary rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-white\"})})]});}if(message.type==='error'){return/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-red-500 rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl rounded-tl-md px-4 py-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-red-800 dark:text-red-200 whitespace-pre-wrap break-words\",children:message.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400 mt-1\",children:formatTimestamp(message.timestamp)})]})]});}// Bot message\nreturn/*#__PURE__*/_jsxs(motion.div,{variants:messageVariants,initial:\"hidden\",animate:\"visible\",transition:{duration:0.3},className:\"flex items-start space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-comviva-secondary rounded-full flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(Bot,{className:\"w-4 h-4 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-2xl rounded-tl-md px-4 py-3 max-w-none overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"markdown-content prose prose-sm max-w-none break-words overflow-wrap-anywhere\",children:message.isStreaming&&!message.content?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 text-gray-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.1s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.2s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Thinking...\"})]}):message.content.includes('[CHART:')?/*#__PURE__*/_jsx(\"div\",{children:message.content.split(/\\[CHART:[^\\]]+\\]/).map((text,index,array)=>{var _chartMatch$index$mat;const chartMatch=message.content.match(/\\[CHART:([^\\]]+)\\]/g);return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ReactMarkdown,{children:text}),index<array.length-1&&chartMatch&&chartMatch[index]&&/*#__PURE__*/_jsxs(\"div\",{className:\"my-4\",children:[chartMatch[index].includes('dashboard')&&/*#__PURE__*/_jsx(UNODashboard,{dashboardType:((_chartMatch$index$mat=chartMatch[index].match(/dashboard:(\\w+)/))===null||_chartMatch$index$mat===void 0?void 0:_chartMatch$index$mat[1])||'overview'}),chartMatch[index].includes('chart')&&/*#__PURE__*/_jsx(ChartRenderer,{type:\"bar\",data:[{name:'SMS',value:45000},{name:'MMS',value:12000},{name:'RCS',value:8000}],title:\"Sample UNO Data\"})]})]},index);})}):/*#__PURE__*/_jsx(ReactMarkdown,{components:{code(_ref2){let{node,inline,className,children}=_ref2,props=_objectWithoutProperties(_ref2,_excluded);const match=/language-(\\w+)/.exec(className||'');return!inline&&match?/*#__PURE__*/_jsx(SyntaxHighlighter,_objectSpread(_objectSpread({style:tomorrow,language:match[1],PreTag:\"div\",className:\"rounded-lg !mt-2 !mb-2\"},props),{},{children:String(children).replace(/\\n$/,'')})):/*#__PURE__*/_jsx(\"code\",_objectSpread(_objectSpread({className:className},props),{},{children:children}));},a(_ref3){let{children,href}=_ref3,props=_objectWithoutProperties(_ref3,_excluded2);return/*#__PURE__*/_jsxs(\"a\",_objectSpread(_objectSpread({href:href,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-comviva-primary hover:text-blue-700 underline inline-flex items-center gap-1\"},props),{},{children:[children,/*#__PURE__*/_jsx(ExternalLink,{className:\"w-3 h-3\"})]}));}},children:message.content})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:formatTimestamp(message.timestamp)}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleCopy(message.content),className:\"text-xs text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 flex items-center space-x-1 transition-colors\",children:[/*#__PURE__*/_jsx(Copy,{className:\"w-3 h-3\"}),/*#__PURE__*/_jsx(\"span\",{children:copied?'Copied!':'Copy'})]})]})]})]});};export default MessageBubble;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}